<!DOCTYPE html>
<html>
    <head>
        <meta charset=utf-8 />
        <title>Leaflet.markercluster</title>

        <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no' />
        <script src='http://api.tiles.mapbox.com/mapbox.js/v1.4.2/mapbox.js'></script>
        <link href='http://api.tiles.mapbox.com/mapbox.js/v1.4.2/mapbox.css' rel='stylesheet' />

        <link href='css/style-map.css' rel='stylesheet' />
       
    </head>
    <body>
        <!--
          Include Leaflet.markercluster's CSS and JavaScript assets.
          Unlike mapbox.js, these are not hosted by MapBox; you will
          need to download and host them yourself.
        
          Note that the 0.2 release of Leaflet.markercluster is not
          compatible with the version of Leaflet used by mapbox.js.
          This example uses assets from the master branch (@ 6fda9a206)
          of https://github.com/Leaflet/Leaflet.markercluster.
        -->
        <link rel="stylesheet" href="css/MarkerCluster.css" />
        <link rel="stylesheet" href="css/MarkerCluster.Default.css" />
        <!--[if lte IE 8]>
          <link rel="stylesheet" href="css/MarkerCluster.Default.ie.css" />
        <![endif]-->
        <script src="css/leaflet.markercluster.js"></script>

        <!-- Example data. -->
        <script src="https://www.mapbox.com/mapbox.js/assets/realworld.388.js"></script>
        <script src="http://localhost:8080/appdel/SOptener_crimenes"></script>


        <div id='map'></div>



        <script>
            /* var map = L.mapbox.map('map', 'examples.map-9ijuk24y')
             .setView([-37.82, 175.215], 14);
             
             var markers = new L.MarkerClusterGroup();
             
             for (var i = 0; i < addressPoints.length; i++) {
             var a = addressPoints[i];
             var title = a[2];
             var marker = L.marker(new L.LatLng(a[0], a[1]), {
             icon: L.mapbox.marker.icon({'marker-symbol': 'post', 'marker-color': '0044FF'}),
             title: title
             });
             marker.bindPopup(title);
             markers.addLayer(marker);
             }
             
             map.addLayer(markers);*/
            var map = L.mapbox.map('map', 'examples.map-9ijuk24y')
                    .setView([-13.1624, -74.2159], 15);
            var markers = new L.MarkerClusterGroup();
            for (var i = 0; i < addressPoints.length; i++) {

                console.log(addressPoints[i]);
                //var a = addressPoints[i];
                var title = addressPoints[i].tipo;
                var imagen = "crimen_imagenes/" + addressPoints[i].imagen;

                var marker_simbol = 'post';
                var marker = L.marker(new L.LatLng(addressPoints[i].latitud, addressPoints[i].longitud), {
                    icon: L.mapbox.marker.icon({'marker-symbol': marker_simbol, 'marker-color': '456789'}),
                    title: title,
                    imagen: imagen

                });
                //marker.bindPopup(title);
                marker.bindPopup("<h2>" + title + "</h2><img class='img-popup' src=" + imagen + "><br><a href='#' onclick='fun_detalle'>MÃ¡s detalles</a>");
                markers.addLayer(marker);
            }

            map.addLayer(markers);
        </script>
    </body>
</html>